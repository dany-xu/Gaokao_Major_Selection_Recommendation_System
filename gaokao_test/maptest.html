<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css" />
    <script src="jquery-3.6.0.min.js"></script>
    <script src="bootstrap.js"></script>
    <script src="vue.min.js"></script>
    <script src="vue-resource.js"></script>

    <title>地图显示</title>
    <style>
        html,
        body,
        #container {
            width: 100%;
            height: 100%;
        }
        
        #href_jump {
            text-decoration: none
        }
        
        .info {
            font-size: 20px;
        }
    </style>
</head>

<body>
    <div id="container"></div>
    <!-- 加载地图JSAPI脚本 -->
    <script src="https://webapi.amap.com/maps?v=1.4.15&key=0a1ee845d4a7299bc94b6985a50c8d47"></script>
    <div class='info'>
        点击地图获取省份
        <br>
        <a href="test.html" id="href_jump">选择完成</a>

    </div>



    <div class="input-card" style='width:28rem;'>
        <label style='color:grey'>经纬度转换</label>
        <div class="input-item">
            <div class="input-item-prepend"><span class="input-item-text">经纬度</span></div>
            <input id='lnglat' type="text" value='116.39,39.9'>
        </div>
        <div class="input-item">
            <div class="input-item-prepend"><span class="input-item-text">地址</span></div>
            <input id='address' type="text" disabled>
        </div>
        <input id="regeo" type="button" class="btn" value="经纬度 -> 地址">
    </div>

    <script src="https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js"></script>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=0a1ee845d4a7299bc94b6985a50c8d47&plugin=AMap.Geocoder"></script>

    <script type="text/javascript">
        var map = new AMap.Map('container', {
            resizeEnable: true, //是否监控地图容器尺寸变化
            zoom: 5, //初始化地图层级
            center: [118.761509, 32.006294] //初始化地图中心点
        });
        //弹窗提示
        var click_lnglat = ''
        map.on('click', function(e) {
            // alert('您在[ ' + e.lnglat.getLng() + ',' + e.lnglat.getLat() + ' ]的位置点击了地图！');
            // alert('您没有在[ ' + e.lnglat + ' ]的位置点击了地图！');
            click_lnglat = e.lnglat
                // alert('您在[ ' + click_lnglat + ' ]的位置点击了地图！');

        });
        console.log(click_lnglat)

        var geocoder = new AMap.Geocoder({
            city: "010", //城市设为北京，默认：“全国”
            radius: 1000 //范围，默认：500
        });
        var marker = new AMap.Marker();

        //字符串匹配
        var province_list = ['河南', '天津', '海南', '江苏', '陕西', '青海', '澳门', '香港', '上海', '山西', '江西', '黑龙江', '浙江', '贵州',
            '西藏', '山东', '河北', '辽宁', '福建', '新疆', '湖北', '湖南', '吉林', '广东', '北京', '台湾', '重庆', '安徽', '广西',
            '甘肃', '宁夏', '云南', '四川', '内蒙古'
        ]
        var school_list = [
            ['郑州大学'],
            [],
            [],
            ['南京大学', '东南大学', '苏州大学', '南京航空航天大学', '南京理工大学', '南京工业大学', '河海大学', '江南大学', '南通大学', '南京农业大学', '南京师范大学', '南京财经大学', '中国药科大学'],
            ['西北大学', '西安交通大学', '西安电子科技大学', '长安大学'],
            [],
            [],
            [],
            ['复旦大学', '同济大学', '上海交通大学', '华东理工大学', '东华大学', '华东师范大学', '上海师范大学', '上海外国语大学', '华东政法大学', '上海大学', '复旦大学医学部'],
            ['太原理工大学'],
            ['南昌大学'],
            ['哈尔滨工业大学', '东北农业大学', '东北林业大学'],
            ['浙江大学', '杭州电子科技大学', '浙江工业大学', '浙江理工大学'],
            ['贵州大学'],
            [],
            ['山东大学', '中国海洋大学', '青岛大学'],
            ['燕山大学'],
            ['辽宁大学', '大连理工大学', '大连海事大学'],
            ['厦门大学', '华侨大学', '福州大学', '福建农林大学'],
            ['新疆大学', '石河子大学'],
            ['武汉大学', '华中科技大学', '武汉科技大学', '中国地质大学（武汉）', '华中农业大学', '华中师范大学', '湖北大学'],
            ['湖南大学', '中南大学', '湖南师范大学'],
            ['吉林大学', '延边大学', '东北师范大学'],
            ['暨南大学', '汕头大学', '华南理工大学', '广州大学'],
            ['北京大学', '中国人民大学', '清华大学', '北京交通大学', '北京航空航天大学', '北京理工大学', '北京科技大学', '北方工业大学', '北京化工大学', '北京工商大学', '北京邮电大学', '北京林业大学', '北京师范大学', '首都师范大学', '北京外国语大学', '中国传媒大学', '对外经贸大学', '北京体育大学', '华北电力大学', '中国矿业大学（北京）', '中国地质大学（北京）', '北京联合大学'],
            [],
            ['西南大学', '重庆大学'],
            ['安徽大学', '中国科学技术大学', '合肥工业大学'],
            ['广西大学'],
            ['兰州大学'],
            [],
            [],
            ['四川大学', '西南交通大学', '四川农业大学'],
            ['内蒙古大学']

        ]
        var address_final = '';

        function regeoCode() {

            var lnglat = document.getElementById('lnglat').value.split(',');
            map.add(marker);
            marker.setPosition(lnglat);

            geocoder.getAddress(lnglat, function(status, result) {
                if (status === 'complete' && result.regeocode) {
                    var address = result.regeocode.formattedAddress;
                    document.getElementById('address').value = address;
                    address_final = address;
                    for (var i = 0; i < province_list.length; i++) {

                        if (address_final.search(province_list[i]) != -1) {
                            address_final = province_list[i];
                            var school = school_list[i];
                            console.log(address_final);
                        }
                    }
                    localStorage.province = address_final;
                    console.log(localStorage.province);
                    alert('您选择了[ ' + address_final + '省' + ' ]！\n 这个省份所有的大学如下[' + school + ']! ');


                } else {
                    log.error('根据经纬度查询地址失败')
                }
            });
        }
        //省份字符串匹配
        function getFinalAddress() {

        }

        map.on('click', function(e) {
            document.getElementById('lnglat').value = e.lnglat;
            regeoCode();
        })
        document.getElementById("regeo").onclick = regeoCode;
        document.getElementById('lnglat').onkeydown = function(e) {
            if (e.keyCode === 13) {
                regeoCode();
                return false;
            }
            return true;
        };
    </script>

</body>

</html>